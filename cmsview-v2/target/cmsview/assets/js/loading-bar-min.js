/*! 
 * angular-loading-bar v0.7.1
 * https://chieffancypants.github.io/angular-loading-bar
 * Copyright (c) 2015 Wes Cruver
 * License: MIT
 */
(function(){angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]);angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]);angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(a){var b=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(j,k,f,l,n,h){var g=0;var c=0;var e=h.latencyThreshold;var d;function i(){f.cancel(d);h.complete();c=0;g=0}function m(p){var o;var r=k.get("$http");var s=a.defaults;if((p.cache||s.cache)&&p.cache!==false&&(p.method==="GET"||p.method==="JSONP")){o=angular.isObject(p.cache)?p.cache:angular.isObject(s.cache)?s.cache:r}var q=o!==undefined?o.get(p.url)!==undefined:false;if(p.cached!==undefined&&q!==p.cached){return p.cached}p.cached=q;return q}return{request:function(o){if(!o.ignoreLoadingBar&&!m(o)){l.$broadcast("cfpLoadingBar:loading",{url:o.url});if(g===0){d=f(function(){h.start()},e)}g++;h.set(c/g)}return o},response:function(o){if(!o||!o.config){n.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50");return o}if(!o.config.ignoreLoadingBar&&!m(o.config)){c++;l.$broadcast("cfpLoadingBar:loaded",{url:o.config.url,result:o});if(c>=g){i()}else{h.set(c/g)}}return o},responseError:function(o){if(!o||!o.config){n.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50");return j.reject(o)}if(!o.config.ignoreLoadingBar&&!m(o.config)){c++;l.$broadcast("cfpLoadingBar:loaded",{url:o.config.url,result:o});if(c>=g){i()}else{h.set(c/g)}}return j.reject(o)}}}];a.interceptors.push(b)}]);angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.includeSpinner=true;this.includeBar=true;this.latencyThreshold=100;this.startSize=0.02;this.parentSelector="body";this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>';this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>';this.$get=["$injector","$document","$timeout","$rootScope",function(o,v,u,h){var p;var c=this.parentSelector,i=angular.element(this.loadingBarTemplate),d=i.find("div").eq(0),f=angular.element(this.spinnerTemplate);var q,r,a=false,m=0;var g=this.includeSpinner;var j=this.includeBar;var t=this.startSize;function s(){if(!p){p=o.get("$animate")}var w=v.find(c).eq(0);u.cancel(r);if(a){return}h.$broadcast("cfpLoadingBar:started");a=true;if(j){p.enter(i,w,angular.element(w[0].lastChild))}if(g){p.enter(f,w,angular.element(w[0].lastChild))}l(t)}function l(x){if(!a){return}var w=(x*100)+"%";d.css("width",w);m=x;u.cancel(q);q=u(function(){k()},250)}function k(){if(b()>=1){return}var w=0;var x=b();if(x>=0&&x<0.25){w=(Math.random()*(5-3+1)+3)/100}else{if(x>=0.25&&x<0.65){w=(Math.random()*3)/100}else{if(x>=0.65&&x<0.9){w=(Math.random()*2)/100}else{if(x>=0.9&&x<0.99){w=0.005}else{w=0}}}}var y=b()+w;l(y)}function b(){return m}function e(){m=0;a=false}function n(){if(!p){p=o.get("$animate")}h.$broadcast("cfpLoadingBar:completed");l(1);u.cancel(r);r=u(function(){var w=p.leave(i,e);if(w&&w.then){w.then(e)}p.leave(f)},500)}return{start:s,set:l,status:b,inc:k,complete:n,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})})();